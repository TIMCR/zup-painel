<div class="loadingRequest" ng-show="processingForm"><img src="assets/images/loading_white.gif"/></div>

<div ng-show="loading">
  <div class="loading"></div>
</div>

<div id="full_page" ng-hide="loading">
  <div class="header">
    <a ng-href="#/cases" class="back">
      <span class="glyphicon glyphicon-chevron-left"></span>
    </a>

    <div class="title">
      {{ kase.flow.title}} #{{ kase.id }}
    </div>

    <div class="updated-msg case">
      <span class="header-msg">Estado do caso</span>
      <span class="status-msg">{{ kase.status }}</span>
    </div>
  </div>

  <div class="spacing"></div>

  <div class="tabs case">
    <a href="" ng-click="currentTab = 'steps'" ng-class="{'active': currentTab == 'steps'}">Etapas</a>
    <a href="" ng-click="currentTab = 'history'" ng-class="{'active': currentTab == 'history'}">Hist√≥rico</a>
    <a href="" ng-click="currentTab = 'chat'" class="tab-last" ng-class="{'active': currentTab == 'chat'}">Mensagens</a>
  </div>

  <div ng-show="currentTab == 'steps'" class="edit-triggers clearfix">
    <div class="case-content aside">
      <case-steps ng-if="step"
                  active-step="step"
                  previous-steps="kase.previous_steps"
                  current-step="kase.current_step"
                  next-steps="kase.next_steps"
                  on-step-select="selectStep(step)"></case-steps>

      <related-reports reports="kase.related_entities.report_items"
                       ng-if="kase.related_entities && kase.related_entities.report_items"></related-reports>

      <ul class="case-aside-bottom-list" ng-if="canManageCase">
        <li><a href="" class="error" ng-if="canManageCase()" ng-click="inactiveCase(kase)"><span class="glyphicon glyphicon-trash"></span>Excluir caso</a></li>
      </ul>
    </div>

    <case-step ng-if="step"
               step="step"
               editable="step.editable"
               save-in-progress="saveInProgress"
               on-step-save="saveStep(fields)"
               on-change-conductor="changeConductor()"></case-step>

    <div class="clearfix"></div>
  </div>

  <div ng-if="currentTab == 'history'" class="edit-triggers clearfix">
    <case-history id="kase.id" ng-if="kase.id"></case-history>
  </div>

  <div class="clearfix" ng-show="currentTab == 'chat'">
    <div class="chat-window">
      <zup-chat user="user" chattable-type="case" chattable-id="{{ kase.id }}" ng-if="kase.id"></zup-chat>
    </div>
  </div>
</div>
